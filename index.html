<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV æè¿°æ€§çµ±è¨ˆåˆ†æ (DuckDB-Wasm)</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@duckdb/duckdb-wasm/dist/duckdb-wasm.js"></script>
<script>
  const duckdb = window.duckdbWasm || window.duckdb;  
  const JSDELIVR_BUNDLES = duckdb.getJsDelivrBundles();  
  const bundle          = await duckdb.selectBundle(JSDELIVR_BUNDLES);
  const workerUrl = URL.createObjectURL(
    new Blob([`importScripts("${bundle.mainWorker}")`], {type:'text/javascript'})
  );
  const worker = new Worker(workerUrl);
  const logger = new duckdb.ConsoleLogger();
  const db     = new duckdb.AsyncDuckDB(logger, worker);
  await db.instantiate(bundle.mainModule, bundle.pthreadWorker);
</script>
</head>
<body>
    <header>
        <h1>ğŸ“Š CSV æè¿°æ€§çµ±è¨ˆåˆ†æ (ç€è¦½å™¨ç«¯)</h1>
        <p>ä½¿ç”¨ <a href="https://duckdb.org/docs/api/wasm/overview" target="_blank" rel="noopener noreferrer">DuckDB-Wasm</a> ç›´æ¥åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­åˆ†æ CSV æª”æ¡ˆï¼Œç„¡éœ€ä¸Šå‚³åˆ°ä¼ºæœå™¨ã€‚</p>
    </header>

    <main>
        <section id="upload-section">
            <label for="csvFileInput">é¸æ“‡ä¸€å€‹ CSV æª”æ¡ˆ:</label>
            <input type="file" id="csvFileInput" accept=".csv">
            <div id="status">è«‹é¸æ“‡æª”æ¡ˆä»¥é–‹å§‹åˆ†æã€‚</div>
        </section>

        <section id="results-section" style="display: none;">
            <h2>åˆ†æçµæœ</h2>

            <div id="schema-output">
                <h3>æ¨æ–·çš„è¡¨æ ¼çµæ§‹</h3>
                <div id="schema-table-container">è¼‰å…¥ä¸­...</div>
            </div>

            <div id="stats-output">
                <h3>æè¿°æ€§çµ±è¨ˆæ‘˜è¦</h3>
                <div id="stats-table-container">è¨ˆç®—ä¸­...</div>
                <button id="downloadButton" style="display: none;">ğŸ“¥ ä¸‹è¼‰çµ±è¨ˆçµæœ (CSV)</button>
            </div>
        </section>
    </main>

    <footer>
        <p>Powered by DuckDB-Wasm</p>
    </footer>

    <!-- Main JavaScript Logic -->
    <script type="module" src="script.js"></script>
</body>
</html>
